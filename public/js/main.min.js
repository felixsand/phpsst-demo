"use strict";var phpsst=new Vue({el:"#phpsst",data:{errorMsg:"",passwordDisplay:"",secretUrl:"",passwordField:"",passwordConfirmField:"",views:1,hours:0,days:1,page:"enter-details",selectViewsBtnText:"Valid for 1 view",selectDaysBtnText:"Valid for 1 day",selectHoursBtnText:"and 0 hour",selectDays:[],selectHours:[],selectViews:[]},mounted:function(){var s;for(s=0;s<=10;s++)this.selectDays.push(this.getDaysLabel(s));for(s=0;s<=23;s++)this.selectHours.push(this.getHoursLabel(s));for(s=1;s<=10;s++)this.selectViews[s]=this.getViewsLabel(s);window.addEventListener("hashchange",phpsst.checkForSecretKeys,!1),this.checkForSecretKeys()},methods:{reset:function(){this.passwordDisplay="",this.secretUrl="",this.passwordField="",this.passwordConfirmField="",this.views=1,this.hours=0,this.days=1},storeSecret:function(){if(this.errorMsg="",this.passwordConfirmed()){var s=new FormData;s.append("password",this.passwordField),s.append("views",this.views),s.append("ttl",3600*this.hours+3600*this.days*24),fetch("/phppst.php",{method:"post",body:s}).then(function(s){return s.json()}).then(function(s){s.success?phpsst.showUrl(s.secretKey):phpsst.errorMsg=s.errorMsg}).catch(function(s){phpsst.errorMsg="Unknown error"})}},checkForSecretKeys:function(){var s=window.location.hash.substring(1);if(s){this.reset();var e=new FormData;e.append("secretKey",s),fetch("/phppst.php",{method:"post",body:e}).then(function(s){return s.json()}).then(function(s){s.success?(phpsst.passwordDisplay=s.secret,setTimeout(function(){phpsst.focus("password-display")},300)):phpsst.errorMsg=s.errorMsg,phpsst.page="password-display"}).catch(function(s){phpsst.errorMsg="Unknown error",phpsst.page="password-display"})}},focus:function(s){var e=document.getElementById(s);e&&(e.select(),e.focus())},passwordConfirmed:function(){var s=this.passwordField;return s!==this.passwordConfirmField?(this.errorMsg="You need to enter the same password in the confirm field",!1):""!==s||(this.errorMsg="You need to enter a password",!1)},showUrl:function(s){this.secretUrl=window.location.protocol+"//"+window.location.host+window.location.pathname+"#"+s,this.page="get-details",setTimeout(function(){phpsst.focus("secret-url")},300)},resetPage:function(){this.reset(),this.errorMsg="",this.page="enter-details"},getDaysLabel:function(s){var e=s+" day";return s>1&&(e+="s"),e},getHoursLabel:function(s){var e=s+" hour";return s>1&&(e+="s"),e},getViewsLabel:function(s){var e=s+" view";return s>1&&(e+="s"),e},changeViews:function(s){s.preventDefault(),phpsst.views=s.target.getAttribute("data-views"),phpsst.selectViewsBtnText="Valid for "+this.getViewsLabel(phpsst.views)},changeDays:function(s){s.preventDefault(),phpsst.days=s.target.getAttribute("data-days"),phpsst.selectDaysBtnText="Valid for "+this.getDaysLabel(phpsst.days)},changeHours:function(s){s.preventDefault(),phpsst.hours=s.target.getAttribute("data-hours"),phpsst.selectHoursBtnText="and "+this.getHoursLabel(phpsst.hours)}}});